<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Encoding categorization API · CePNEMAnalysis</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CePNEMAnalysis</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../"><code>CePNEMAnalysis.jl</code> Documentation</a></li><li><a class="tocitem" href="../data/">Data IO API</a></li><li><a class="tocitem" href="../decode/">Decoder models API</a></li><li class="is-active"><a class="tocitem" href>Encoding categorization API</a><ul class="internal"><li><a class="tocitem" href="#Encoding-categorization"><span>Encoding categorization</span></a></li><li><a class="tocitem" href="#State-neuron-detection"><span>State neuron detection</span></a></li><li><a class="tocitem" href="#Encoding-subcategorization"><span>Encoding subcategorization</span></a></li><li><a class="tocitem" href="#Encoding-statistics"><span>Encoding statistics</span></a></li><li><a class="tocitem" href="#Helper-functions"><span>Helper functions</span></a></li></ul></li><li><a class="tocitem" href="../encodingchange/">Encoding change detection API</a></li><li><a class="tocitem" href="../encodingmetrics/">Encoding metrics API</a></li><li><a class="tocitem" href="../plot/">Plotting API</a></li><li><a class="tocitem" href="../umap/">UMAP API</a></li><li><a class="tocitem" href="../utility/">Other utility functions API</a></li><li><a class="tocitem" href="../validation/">Encoding validation metrics API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Encoding categorization API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Encoding categorization API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/flavell-lab/CePNEMAnalysis.jl/blob/main/docs/src/encoding.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Encoding-categorization-API"><a class="docs-heading-anchor" href="#Encoding-categorization-API">Encoding categorization API</a><a id="Encoding-categorization-API-1"></a><a class="docs-heading-anchor-permalink" href="#Encoding-categorization-API" title="Permalink"></a></h1><h2 id="Encoding-categorization"><a class="docs-heading-anchor" href="#Encoding-categorization">Encoding categorization</a><a id="Encoding-categorization-1"></a><a class="docs-heading-anchor-permalink" href="#Encoding-categorization" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.categorize_all_neurons" href="#CePNEMAnalysis.categorize_all_neurons"><code>CePNEMAnalysis.categorize_all_neurons</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Categorizes all neurons in all datasets at all time ranges. Returns the neuron categorization, the p-values for it, and the raw (not multiple-hypothesis corrected) p-values.</p><p><strong>Arguments:</strong></p><ul><li><code>fit_results</code>: CePNEM fit results.</li><li><code>deconvolved_activity</code>: Dictionary of deconvolved activity values at lattice points.</li><li><code>P_ranges</code>: Ranges of feeding values</li><li><code>p</code>: Significant <code>p</code>-value.</li><li><code>θh_pos_is_ventral</code>: Whether positive θh value corresponds to ventral (<code>true</code>) or dorsal (<code>false</code>) head bending.</li><li><code>threshold_artifact</code>: Deconvolved activity must differ by at least this much, to filter out motion artifacts</li><li><code>threshold_weak</code>: Non-deconvolved activity must differ by at least this much, to filter out weak overfitting encodings</li><li><code>P_diff_thresh</code> (optional, default <code>0</code>): Minimum feeding variance in a time range necessary for trying to compute feeding info.</li><li><code>rel_enc_str_correct</code> (optional, default <code>0</code>): Threshold for deleting neurons with too low relative encoding strength.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.categorize_neurons" href="#CePNEMAnalysis.categorize_neurons"><code>CePNEMAnalysis.categorize_neurons</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Categorizes all neurons from their deconvolved activities.</p><p><strong>Arguments:</strong></p><ul><li><code>deconvolved_activities_1</code>: Deconvolved activities of neurons.</li><li><code>deconvolved_activities_2</code>: Either 0 (to check neuron encoding), or deconvolved activities of neurons at an earlier time point (to check encoding change).</li><li><code>p</code>: Significant p-value.</li><li><code>θh_pos_is_ventral</code>: Whether positive θh value corresponds to ventral (<code>true</code>) or dorsal (<code>false</code>) head bending.</li><li><code>threshold_artifact</code>: Deconvolved activity must differ by at least this much, to filter out motion artifacts</li><li><code>threshold_weak</code>: Non-deconvolved activity must differ by at least this much, to filter out weak overfitting encodings</li><li><code>relative_encoding_strength</code>: Relative encoding strength of the neurons</li><li><code>rel_enc_str_correct</code>: Threshold for deleting neurons with too low relative encoding strength.</li><li><code>compute_feeding</code> (optional, default <code>true</code>): Whether to consider feeding behavior in the analysis.</li><li><code>ewma1</code> (optional): If set, compute EWMA difference between activities and include it in the <code>all</code> category. Put the EWMA values for the later timepoint here.</li><li><code>ewma2</code> (optional): If set, compute EWMA difference between activities and include it in the <code>all</code> category. Put the EWMA values for the earlier timepoint here.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.get_all_neurons_with_feature" href="#CePNEMAnalysis.get_all_neurons_with_feature"><code>CePNEMAnalysis.get_all_neurons_with_feature</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_all_neurons_with_feature(fit_results::Dict{String, Any}, analysis_dict::Dict{String, Any}, beh::String, sub_behs::Union{Nothing, Vector{String}}, p::Float64=0.05)</code></pre><p>Get all neurons that encode a given behavior or sub-behavior feature.</p><p><strong>Arguments:</strong></p><ul><li><code>fit_results::Dict{String, Any}</code>: A dictionary containing the results of fitting CePNEM to neural data.</li><li><code>analysis_dict::Dict{String, Any}</code>: A dictionary containing the results of analyzing the neural data.</li><li><code>beh::String</code>: Find neurons that encode this behavior and the corresponding sub-behavior.</li><li><code>sub_behs::Union{Nothing, Vector{String}}</code>: Find neurons that encode this sub-behavior. If <code>nothing</code>, only encodings of the main behavior are considered.</li><li><code>p::Float64=0.05</code>: The p-value threshold for considering a neuron to have the given feature.</li></ul><p><strong>Returns:</strong></p><ul><li><code>neurons_use::Dict{String, Vector{Int32}}</code>: A dictionary containing the indices of the neurons with the given feature for each dataset.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.get_random_sample_without_feature" href="#CePNEMAnalysis.get_random_sample_without_feature"><code>CePNEMAnalysis.get_random_sample_without_feature</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_random_sample_without_feature(fit_results::Dict{String, Any}, analysis_dict::Dict{String, Any}, neurons_with_feature::Dict{String, Vector{Int32}})</code></pre><p>Get a random sample of neurons that do not encode a given feature.</p><p><strong>Arguments:</strong></p><ul><li><code>fit_results::Dict{String, Any}</code>: A dictionary containing the results of fitting CePNEM to neural data.</li><li><code>analysis_dict::Dict{String, Any}</code>: A dictionary containing the results of analyzing the neural data.</li><li><code>neurons_with_feature::Dict{String, Vector{Int32}}</code>: A dictionary containing the indices of the neurons that encode the feature for each dataset.</li></ul><p><strong>Returns:</strong></p><ul><li><code>neurons_use::Dict{String, Vector{Int32}}</code>: A dictionary containing the indices of the neurons without the given feature for each dataset.</li><li><code>traces_use::Dict{String, Array{Float64, 2}}</code>: A dictionary containing the traces of the neurons without the given feature for each dataset.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.get_subcats" href="#CePNEMAnalysis.get_subcats"><code>CePNEMAnalysis.get_subcats</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_subcats(beh)</code></pre><p>Get the subcategories of a given behavior.</p><p><strong>Arguments:</strong></p><ul><li><code>beh::String</code>: A string representing the behavior.</li></ul><p><strong>Returns:</strong></p><ul><li><code>subcats::Vector{Tuple{String, String}}</code>: A vector of tuples representing the subcategories of the behavior.</li></ul></div></section></article><h2 id="State-neuron-detection"><a class="docs-heading-anchor" href="#State-neuron-detection">State neuron detection</a><a id="State-neuron-detection-1"></a><a class="docs-heading-anchor-permalink" href="#State-neuron-detection" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.fit_state_classifier" href="#CePNEMAnalysis.fit_state_classifier"><code>CePNEMAnalysis.fit_state_classifier</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit_state_classifier(x::Matrix{Float64}, t_stim::Int)</code></pre><p>Fit a logistic regression model to classify whether a set of neurons contains &quot;state&quot; information about the indicator function of <code>t_stim</code>,     based on neural data <code>x</code> and the time <code>t_stim</code> at which the hypothesized state change occurred. Returns the trained model and its accuracy.</p><p><strong>Arguments</strong></p><ul><li><code>x::Matrix{Float64}</code>: Input data matrix of size <code>(n_features, n_timepoints)</code>.</li><li><code>t_stim::Int</code>: Time of the hypothesized state change.</li></ul><p><strong>Returns</strong></p><ul><li><code>model</code>: Trained logistic regression model.</li><li><code>accuracy</code>: Accuracy of the trained model.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.compute_state_neuron_candidates" href="#CePNEMAnalysis.compute_state_neuron_candidates"><code>CePNEMAnalysis.compute_state_neuron_candidates</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compute_state_neuron_candidates(
    analysis_dict::Dict, fit_results::Dict, datasets::Vector{String}, strategy::String,
    stim_times::Dict; stim_try=200:50:1400, delta_t::Int=190
)::Dict</code></pre><p>Computes the state neuron candidates for each dataset in <code>datasets</code>. They are found by fitting a logistic regression model to the neural data and determining whether the model can predict the state change better than it can predict control time points.</p><p>The strategy for selecting the neurons is determined by the <code>strategy</code> argument, which can be one of &quot;increase&quot;, &quot;decrease&quot;, or &quot;findall&quot;:</p><ul><li>&quot;increase&quot;: Start from 0 neurons and add state changing neurons until performance no longer improves</li><li>&quot;decrease&quot;: Start from all neurons and remove non-state changing neurons until performance starts to degrade</li><li>&quot;findall&quot;: Find all neurons with positive performance</li></ul><p>The <code>stim_try</code> argument is a range of timepoints to try for the controls.</p><p><strong>Arguments</strong></p><ul><li><code>analysis_dict::Dict</code>: A dictionary containing the CePNEM analysis results.</li><li><code>fit_results::Dict</code>: A dictionary containing the CePNEM fit results.</li><li><code>datasets::Vector{String}</code>: A vector of datasets to use. They must all be heat-stimulation datasets.</li><li><code>strategy::String</code>: The strategy for selecting the neurons.</li><li><code>stim_times::Dict</code>: A dictionary containing the heat stimulus times for each dataset.</li><li><code>stim_try</code>: A range of timepoints to try for the state change controls.</li><li><code>delta_t::Int</code>: The minimum distance between the state change and control timepoints. (Control points closer than this to the real stim are excluded.)</li></ul><p><strong>Returns</strong></p><ul><li><code>state_neuron_candidates::Dict</code>: A dictionary containing the state neuron candidates for each dataset.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.get_frac_responding" href="#CePNEMAnalysis.get_frac_responding"><code>CePNEMAnalysis.get_frac_responding</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_frac_responding(neurons::Vector{Int}, responses::Dict{String, Any}, response_keys::Vector{String}, decide_fn::Function; response_keys_2::Union{Nothing, Vector{String}}=nothing, decide_fn_2::Union{Nothing, Function}=nothing)</code></pre><p>Calculate the fraction of neurons that respond to the heat stimulus in the given way.</p><p><strong>Arguments:</strong></p><ul><li><code>neurons::Vector{String}</code>: A vector of neurons to consider.</li><li><code>responses::Dict{String, Any}</code>: A dictionary containing the responses of the neurons to the stimulus.</li><li><code>response_keys::Vector{String}</code>: A vector of keys corresponding to the response types to consider in the <code>responses</code> dictionary.</li><li><code>decide_fn::Function</code>: A function that takes a response and returns the strength of that response.</li><li><code>response_keys_2::Union{Nothing, Vector{String}}=nothing</code>: A vector of keys to access a second set of responses in the <code>responses</code> dictionary. If <code>nothing</code>, only the first set of responses is used. If set, this is used as a denominator to normalize the responses.</li><li><code>decide_fn_2::Union{Nothing, Function}=nothing</code>: A function that takes a response from the second set of responses and returns a boolean indicating whether the neuron responded. If <code>nothing</code>, all neurons are considered to have responded to the second set of responses.</li></ul><p><strong>Returns:</strong></p><ul><li><code>frac_responding::Float64</code>: The fraction of neurons that responded to the stimulus.</li></ul></div></section></article><h2 id="Encoding-subcategorization"><a class="docs-heading-anchor" href="#Encoding-subcategorization">Encoding subcategorization</a><a id="Encoding-subcategorization-1"></a><a class="docs-heading-anchor-permalink" href="#Encoding-subcategorization" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.subcategorize_all_neurons!" href="#CePNEMAnalysis.subcategorize_all_neurons!"><code>CePNEMAnalysis.subcategorize_all_neurons!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">subcategorize_all_neurons!(fit_results::Dict, analysis_dict::Dict, datasets::Vector{String})</code></pre><p>Subcategorizes all neurons in the given <code>datasets</code> based on their encoding properties and stores the results in <code>analysis_dict</code>.</p><p><strong>Arguments</strong></p><ul><li><code>fit_results::Dict</code>: A dictionary containing the results of fitting CePNEM to the data.</li><li><code>analysis_dict::Dict</code>: A dictionary to store the results of the analysis.</li><li><code>datasets::Vector{String}</code>: A vector of dataset names to analyze.</li></ul><p><strong>Output</strong></p><ul><li><code>analysis_dict</code> is updated with the results of the analysis.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.sum_subencodings" href="#CePNEMAnalysis.sum_subencodings"><code>CePNEMAnalysis.sum_subencodings</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sum_subencodings(
    fit_results::Dict, analysis_dict::Dict, relative_encoding_strength::Dict,
    datasets::Vector{String}; mode::String=&quot;relative&quot;, sufficient_threshold::Float64=1/3
)</code></pre><p>Calculate the sum of subencodings for each behavior and subcategory.</p><p><strong>Arguments</strong></p><ul><li><code>fit_results::Dict</code>: A dictionary containing the results of fitting CePNEM to the data.</li><li><code>analysis_dict::Dict</code>: A dictionary containing the CePNEM analysis results, specifically the neuron categorization and relative encoding strength.</li><li><code>relative_encoding_strength::Dict</code>: A dictionary containing the relative encoding strength for each behavior in each neuron.</li><li><code>datasets::Vector{String}</code>: A vector of strings containing the names of the datasets to analyze.</li><li><code>mode::String</code>: A string indicating the mode of computation. Possible values are &quot;relative&quot;, &quot;encoding&quot;, and &quot;sufficient&quot;. Default is &quot;relative&quot;.</li><li><code>sufficient_threshold::Float64</code>: A float indicating the threshold for sufficient encoding. Default is 1/3. Does nothing for relative and sufficient modes.</li></ul><p><strong>Returns</strong></p><ul><li><code>dict_result::Dict</code>: A dictionary containing the sum of subencodings for each behavior and subcategory.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.normalize_subencodings" href="#CePNEMAnalysis.normalize_subencodings"><code>CePNEMAnalysis.normalize_subencodings</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">normalize_subencodings(dict_result::Dict) -&gt; Dict</code></pre><p>Normalize the subencodings in the given dictionary per behavior. </p><p><strong>Arguments</strong></p><ul><li><code>dict_result::Dict</code>: A dictionary containing the sum of subencodings for each behavior and subcategory.</li></ul><p><strong>Returns</strong></p><ul><li><code>dict_result_norm::Dict</code>: A dictionary containing the normalized sum of subencodings for each behavior and subcategory.</li></ul></div></section></article><h2 id="Encoding-statistics"><a class="docs-heading-anchor" href="#Encoding-statistics">Encoding statistics</a><a id="Encoding-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Encoding-statistics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.get_neuron_category" href="#CePNEMAnalysis.get_neuron_category"><code>CePNEMAnalysis.get_neuron_category</code></a> — <span class="docstring-category">Function</span></header><section><div><p>get<em>neuron</em>category(dataset::String, rng::Int, neuron::Int, fit<em>results::Dict, neuron</em>categorization::Dict, relative<em>encoding</em>strength::Dict)::Tuple{Array{Tuple{String, String}, 1}, Array{Float64, 1}, Float64}</p><p>Returns the encoding categories, relative encoding strengths, and time constants for a given neuron in a given dataset and time range.</p><p><strong>Arguments:</strong></p><ul><li><code>dataset::String</code>: The name of the dataset.</li><li><code>rng::Int</code>: The index of the time range.</li><li><code>neuron::Int</code>: The index of the neuron.</li><li><code>fit_results::Dict</code>: The dictionary of CePNEM fit results.</li><li><code>neuron_categorization::Dict</code>: The dictionary of neuron categorizations.</li><li><code>relative_encoding_strength::Dict</code>: The dictionary of relative encoding strengths.</li></ul><p><strong>Returns:</strong></p><ul><li><code>encoding::Array{Tuple{String, String}, 1}</code>: An array of tuples representing the encoding categories of the neuron.</li><li><code>relative_enc_str::Array{Float64, 1}</code>: An array of the relative encoding strengths of the neuron.</li><li><code>τ::Float64</code>: The time constant of the neuron, in seconds.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.get_enc_stats" href="#CePNEMAnalysis.get_enc_stats"><code>CePNEMAnalysis.get_enc_stats</code></a> — <span class="docstring-category">Function</span></header><section><div><p>get<em>enc</em>stats(fit<em>results::Dict, neuron</em>p::Dict, P<em>ranges::Dict; encoding</em>changes=nothing, P<em>diff</em>thresh::Float64=0.5, p::Float64=0.05, rngs_valid=nothing)</p><p>Returns a tuple containing a dictionary containing statistics about the encoding categories of neurons across all datasets and a list of skipped datasets.</p><p><strong>Arguments:</strong></p><ul><li><code>fit_results::Dict</code>: CePNEM fit results.</li><li><code>neuron_p::Dict</code>: Dictionary of p-values for neuron categorization.</li><li><code>P_ranges::Dict</code>: Ranges of feeding values.</li><li><code>P_diff_thresh::Float64</code> (optional, default <code>0.5</code>): Minimum feeding variance in a time range necessary for trying to compute feeding info.</li><li><code>p::Float64</code> (optional, default <code>0.05</code>): Significant <code>p</code>-value.</li><li><code>rngs_valid::Any</code> (optional, default <code>nothing</code>): If set, restrict the ranges that are considered for each dataset to this.</li></ul><p><strong>Returns:</strong></p><ul><li><code>result::Dict{String,Dict}</code>: A dictionary containing statistics about the encoding categories of neurons across all datasets.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.get_enc_stats_pool" href="#CePNEMAnalysis.get_enc_stats_pool"><code>CePNEMAnalysis.get_enc_stats_pool</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_enc_stats_pool(fit_results::Dict, neuron_p::Dict, P_ranges::Dict; P_diff_thresh::Float64=0.5, p::Float64=0.05, rngs_valid=nothing)</code></pre><p>This function calculates the encoding statistics for a pool of datasets. It calls the <code>get_enc_stats</code> function for each dataset and aggregates the results.</p><p><strong>Arguments</strong></p><ul><li><code>fit_results::Dict</code>: A dictionary containing the results of fitting CePNEM to the data.</li><li><code>neuron_p::Dict</code>: A dictionary containing the p-values for neuron categorization.</li><li><code>P_ranges::Dict</code>: A dictionary containing the ranges of pumping information.</li><li><code>P_diff_thresh::Float64</code>: The minimum difference in pumping information required to consider a time range valid.</li><li><code>p::Float64</code>: Significant <code>p</code>-value.</li><li><code>rngs_valid::Union{Nothing, Dict}</code>: A dictionary containing the valid ranges for each dataset. If <code>nothing</code>, all ranges are considered valid.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple containing the following:<ul><li><code>n_neurons_beh::Array{Int,1}</code>: An array containing the number of neurons that encode each behavior.</li><li><code>n_neurons_npred::Array{Int,1}</code>: An array containing the number of neurons that encode each number of behaviors.</li><li><code>n_neurons_fit_all::Int</code>: The total number of neurons that encoded any behavior.</li><li><code>n_neurons_tot_all::Int</code>: The total number of neurons.</li></ul></li></ul></div></section></article><h2 id="Helper-functions"><a class="docs-heading-anchor" href="#Helper-functions">Helper functions</a><a id="Helper-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.make_deconvolved_lattice" href="#CePNEMAnalysis.make_deconvolved_lattice"><code>CePNEMAnalysis.make_deconvolved_lattice</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_deconvolved_lattice(fit_results, beh_percent, plot_thresh; dataset_mapping=nothing)</code></pre><p>Makes deconvolved lattices for each dataset, time range, and neuron in <code>fit_results</code>. Returns velocity, head angle, and pumping ranges, and the deconvolved activity of each neuron at each lattice point defined by them, for both statistically useful ranges (first return value), and full ranges (second return value) designed for plotting consistency. Set <code>dataset_mapping</code> to change which behavioral dataset to use for computing ranges.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.get_deconvolved_activity" href="#CePNEMAnalysis.get_deconvolved_activity"><code>CePNEMAnalysis.get_deconvolved_activity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_deconvolved_activity(sampled_trace_params, v_rng, θh_rng, P_rng)</code></pre><p>Computes deconvolved activity of model NL8 for each sampled parameter in <code>sampled_trace_params</code>, at a lattice defined by <code>v_rng</code>, <code>θh_rng</code>, and <code>P_rng</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.compute_range" href="#CePNEMAnalysis.compute_range"><code>CePNEMAnalysis.compute_range</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compute_range(beh::Vector{Float64}, beh_percent::Real, beh_idx::Int)</code></pre><p>Computes the valid range of a behavior <code>beh</code> (eg: velocity cropped to a given time range). Computes percentile based on <code>beh_percent</code>, and uses 4 points instead of 2 for velocity (<code>beh_idx = 1</code>)</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.deconvolved_model_nl8" href="#CePNEMAnalysis.deconvolved_model_nl8"><code>CePNEMAnalysis.deconvolved_model_nl8</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">deconvolved_model_nl8(params::Vector{Float64}, v::Float64, θh::Float64, P::Float64)</code></pre><p>Evaluate model NL8, deconvolved, given <code>params</code> and <code>v</code>, <code>θh</code>, and <code>P</code>. Does not use the sigmoid. Expression is equivalent to evaluating NL10d since this function does not include the residual model.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.neuron_p_vals" href="#CePNEMAnalysis.neuron_p_vals"><code>CePNEMAnalysis.neuron_p_vals</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">neuron_p_vals(
    deconvolved_activity_1, deconvolved_activity_2, signal, threshold_artifact::Real, threshold_weak::Real, 
    relative_encoding_strength; compute_p::Bool=true, metric::Function=abs, stat::Function=median
)</code></pre><p>Computes neuron p-values by comparing differences between two different deconvolved activities to a threshold. (Ie: the p-value of rejecting the null hypothesis that the difference is negative or less than the threshold -  if p=0, then we can conclude the neuron has the given activity.) To find encoding of a neuron, set the second activity to 0. To find encoding change, set it to a different time window. To find distance between neurons, set <code>compute_p = false</code> and specify the <code>metric</code> (default <code>abs</code>) to use to compare medians of the two posteriors. To use a statistic other than median, change <code>stat</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.update_cmap!" href="#CePNEMAnalysis.update_cmap!"><code>CePNEMAnalysis.update_cmap!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update_cmap!(cmap, x, y)</code></pre><p>Updates choice map <code>cmap</code> to contain parameters <code>x</code> and/or neural data <code>y</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.prob_P_greater_Q" href="#CePNEMAnalysis.prob_P_greater_Q"><code>CePNEMAnalysis.prob_P_greater_Q</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">prob_P_greater_Q(P,Q)</code></pre><p>Computes <code>Prob(p&gt;q) + Prob(p=q)/2</code> for <code>p~P</code>, <code>q~Q</code> Here <code>P</code> and <code>Q</code> are arrays of samples.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="CePNEMAnalysis.evaluate_pdf_xgiveny!" href="#CePNEMAnalysis.evaluate_pdf_xgiveny!"><code>CePNEMAnalysis.evaluate_pdf_xgiveny!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_pdf_xgiveny!(x, y_cmap, args, log_ml_est)</code></pre><p>Given parameters <code>x</code> (given as an array of the 9 parameters for <code>nl8</code>), observed data <code>y_cmap</code> (neural data, given as a <code>choicemap)</code>, <code>args</code> (behavioral data), and <code>log_ml_est</code> from a Gen inference run on <code>y, args</code>, computes <code>P(x | y, args)</code> under model <code>nl8</code>. Updates <code>y_cmap</code> to contain <code>x</code> values as well.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../decode/">« Decoder models API</a><a class="docs-footer-nextpage" href="../encodingchange/">Encoding change detection API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 14 July 2023 02:46">Friday 14 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
